1. What APIS do
- like any other functions:
	change data structures
	read,write,modify,delete
	control, read or write to devices
	implement some algorithms/logic

2. example of using apis to call notepad
- when you write a C++ program to use win apis to open notepad.exe
	+ you pass higher-level parameters to the OS
	+ these parameters are used by the OS to build PEB
		 PEB has a fixed data structure
		 When CreateProcess alls down to NTCreateUSerProcess, the kernel:
			allocates a new process object (Eprocess)
			creates a new address space
			map the exe image into memory
			allocates memory for a PEB and fills it with
				image base address
				loader data
				process parameters (passed from args)
				default head point,....
	+ then the OS allocates a TEB (thread environment block)
	+ sets up the initial thread stack and cpu context


| **Cooking analogy**                                                                                                                 | **What happens in Windows**                                                                                                                   |
| ----------------------------------------------------------------------------------------------------------------------------------- | --------------------------------------------------------------------------------------------------------------------------------------------- |
| ğŸ§¾ **You (the caller) list the ingredients** â€” you say *what dish you want* and *what ingredients to use* (e.g., flour, salt, oil). | You call **`CreateProcess`** and pass arguments â€” the **path to the EXE**, **command line**, **environment variables**, and **startup info**. |
| ğŸ‘¨â€ğŸ³ **The chef** knows the **recipe** â€” he knows the sequence of steps to prepare that dish.                                      | The **Windows kernel + loader (NTDLL)** have a **fixed recipe** â€” the sequence of internal steps for process creation and initialization.     |
| ğŸ² **The chef takes a new pot** â€” clean, isolated, ready to use.                                                                    | The OS **creates a new address space** â€” an empty, isolated memory map (this is your â€œnew potâ€).                                              |
| ğŸ”¥ **He puts the pot on the stove** â€” assigns it to a burner to be cooked.                                                          | The kernel **registers the process and thread** with the scheduler â€” gives them CPU time and system resources.                                |
| ğŸ¥• **He fills the pot with ingredients** â€” using your ingredient list.                                                              | The kernel + NTDLL **fill the new processâ€™s memory** (PEB, parameters, environment, loaded image) using your inputs.                          |
| ğŸ§‘â€ğŸ³ **The chef starts cooking** â€” begins the cooking process.                                                                     | The **primary thread starts executing**, running the processâ€™s startup code (like `_NtProcessStartup â†’ mainCRTStartup â†’ main`).               |
